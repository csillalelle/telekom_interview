[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - 690529 - LOGS_CAPTURED - Started capturing logs in process (pid: 690529).
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - 690529 - actions_activities - STEP_START - Started execution of step "actions_activities".
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities - Loading file from: /workspaces/data-scientist-at-magenta/dagster_home/storage/current_model using PickledObjectFilesystemIOManager...
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - 690529 - actions_activities - LOADED_INPUT - Loaded input "current_model" using input manager "io_manager", from output "result" of step "current_model"
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities - Loading file from: /workspaces/data-scientist-at-magenta/dagster_home/storage/predictions using PickledObjectFilesystemIOManager...
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - 690529 - actions_activities - LOADED_INPUT - Loaded input "predictions" using input manager "io_manager", from output "result" of step "predictions"
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - 690529 - actions_activities - STEP_INPUT - Got input "current_model" of type "Any". (Type check passed).
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - 690529 - actions_activities - STEP_INPUT - Got input "predictions" of type "Any". (Type check passed).
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities - Starting actions generation
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities - Using model ID: model_001
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities - Found 361 positive predictions out of 1000 total predictions
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities - Checking for recently actioned customers/contracts
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities - Found 779 customer/contract combinations actioned in last 30 days
/workspaces/data-scientist-at-magenta/src/code_location_interview/code_location_interview/assets/actions.py:93: MapWithoutReturnDtypeWarning: Calling `map_elements` without specifying `return_dtype` can lead to unpredictable results. Specify `return_dtype` to silence this warning.
  eligible_predictions = positive_predictions.filter(
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities - After filtering recent actions: 361 eligible predictions
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities - Creating actions for eligible predictions
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities - Storing actions in database
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities - Successfully stored 361 new actions. Total actions in database: 1140
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities - Actions summary:
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities -   - Total actions created: 361
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities -   - Unique customers: 297
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities -   - Unique contracts: 361
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities -   - Model used: model_001
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities -   - Cooldown period: 30 days
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities - Actions generation completed successfully
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - 690529 - actions_activities - STEP_OUTPUT - Yielded output "result" of type "Any". (Type check passed).
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - actions_activities - Writing file at: /workspaces/data-scientist-at-magenta/dagster_home/storage/actions_activities using PickledObjectFilesystemIOManager...
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - 690529 - actions_activities - ASSET_MATERIALIZATION - Materialized value actions_activities.
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - 690529 - actions_activities - HANDLED_OUTPUT - Handled output "result" using IO manager "io_manager"
[32m2025-07-03 01:32:34 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 1560eb95-daaf-42e7-b7be-21324baeb20f - 690529 - actions_activities - STEP_SUCCESS - Finished execution of step "actions_activities" in 633ms.
