[32m2025-07-03 01:35:25 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - 704692 - LOGS_CAPTURED - Started capturing logs in process (pid: 704692).
[32m2025-07-03 01:35:25 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - 704692 - actions_activities - STEP_START - Started execution of step "actions_activities".
[32m2025-07-03 01:35:25 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities - Loading file from: /workspaces/data-scientist-at-magenta/dagster_home/storage/current_model using PickledObjectFilesystemIOManager...
[32m2025-07-03 01:35:25 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - 704692 - actions_activities - LOADED_INPUT - Loaded input "current_model" using input manager "io_manager", from output "result" of step "current_model"
[32m2025-07-03 01:35:25 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities - Loading file from: /workspaces/data-scientist-at-magenta/dagster_home/storage/predictions using PickledObjectFilesystemIOManager...
[32m2025-07-03 01:35:25 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - 704692 - actions_activities - LOADED_INPUT - Loaded input "predictions" using input manager "io_manager", from output "result" of step "predictions"
[32m2025-07-03 01:35:25 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - 704692 - actions_activities - STEP_INPUT - Got input "current_model" of type "Any". (Type check passed).
[32m2025-07-03 01:35:25 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - 704692 - actions_activities - STEP_INPUT - Got input "predictions" of type "Any". (Type check passed).
[32m2025-07-03 01:35:25 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities - Starting actions generation
[32m2025-07-03 01:35:25 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities - Using model ID: model_001
[32m2025-07-03 01:35:25 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities - Found 3809 positive predictions out of 10000 total predictions
[32m2025-07-03 01:35:25 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities - Checking for recently actioned customers/contracts
[32m2025-07-03 01:35:25 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities - Found 4932 customer/contract combinations actioned in last 30 days
/workspaces/data-scientist-at-magenta/src/code_location_interview/code_location_interview/assets/actions.py:93: MapWithoutReturnDtypeWarning: Calling `map_elements` without specifying `return_dtype` can lead to unpredictable results. Specify `return_dtype` to silence this warning.
  eligible_predictions = positive_predictions.filter(
[32m2025-07-03 01:35:25 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities - After filtering recent actions: 3809 eligible predictions
[32m2025-07-03 01:35:25 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities - Creating actions for eligible predictions
[32m2025-07-03 01:35:26 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities - Storing actions in database
[32m2025-07-03 01:35:26 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities - Successfully stored 3809 new actions. Total actions in database: 8741
[32m2025-07-03 01:35:26 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities - Actions summary:
[32m2025-07-03 01:35:26 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities -   - Total actions created: 3809
[32m2025-07-03 01:35:26 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities -   - Unique customers: 3085
[32m2025-07-03 01:35:26 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities -   - Unique contracts: 3809
[32m2025-07-03 01:35:26 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities -   - Model used: model_001
[32m2025-07-03 01:35:26 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities -   - Cooldown period: 30 days
[32m2025-07-03 01:35:26 +0000[0m - dagster - [34mINFO[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities - Actions generation completed successfully
[32m2025-07-03 01:35:26 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - 704692 - actions_activities - STEP_OUTPUT - Yielded output "result" of type "Any". (Type check passed).
[32m2025-07-03 01:35:26 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - actions_activities - Writing file at: /workspaces/data-scientist-at-magenta/dagster_home/storage/actions_activities using PickledObjectFilesystemIOManager...
[32m2025-07-03 01:35:26 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - 704692 - actions_activities - ASSET_MATERIALIZATION - Materialized value actions_activities.
[32m2025-07-03 01:35:26 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - 704692 - actions_activities - HANDLED_OUTPUT - Handled output "result" using IO manager "io_manager"
[32m2025-07-03 01:35:26 +0000[0m - dagster - [34mDEBUG[0m - master_pipeline_job - 12bd723b-0aea-44a4-8b3a-a0861ec501d8 - 704692 - actions_activities - STEP_SUCCESS - Finished execution of step "actions_activities" in 712ms.
