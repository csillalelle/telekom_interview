[32m2025-07-03 00:27:24 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - 504444 - LOGS_CAPTURED - Started capturing logs in process (pid: 504444).
[32m2025-07-03 00:27:24 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - 504444 - tune - STEP_START - Started execution of step "tune".
[32m2025-07-03 00:27:24 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - tune - Starting model tuning process
[32m2025-07-03 00:27:24 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - tune - Loading processed features and labels from database
/workspaces/data-scientist-at-magenta/src/code_location_interview/code_location_interview/assets/training.py:117: DataOrientationWarning: Row orientation inferred during DataFrame construction. Explicitly specify the orientation by passing `orient="row"` to silence this warning.
  features_df = pl.DataFrame(features_result, schema=column_names)
[32m2025-07-03 00:27:24 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - tune - Loaded 1000 feature records
/workspaces/data-scientist-at-magenta/src/code_location_interview/code_location_interview/assets/training.py:136: DataOrientationWarning: Row orientation inferred during DataFrame construction. Explicitly specify the orientation by passing `orient="row"` to silence this warning.
  labels_df = pl.DataFrame(labels_result, schema=labels_column_names)
[32m2025-07-03 00:27:24 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - tune - Using 51 features for training
[32m2025-07-03 00:27:24 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - tune - Dataset shape: X=(1000, 51), y=(1000,)
[32m2025-07-03 00:27:24 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - tune - Target distribution: [932  68]
[32m2025-07-03 00:27:24 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - tune - Train set: (800, 51), Test set: (200, 51)
[32m2025-07-03 00:27:24 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - tune - Starting hyperparameter tuning with Optuna
[32m[I 2025-07-03 00:27:25,374][0m A new study created in RDB with name: random_forest_optimization_retrain_20250703_002724[0m
[32m[I 2025-07-03 00:27:32,507][0m Trial 0 finished with value: 0.0 and parameters: {'n_estimators': 978, 'max_depth': 12, 'min_samples_split': 9, 'min_samples_leaf': 10, 'min_weight_fraction_leaf': 0.2877875263697933, 'max_features': 'sqrt', 'max_samples': 0.26134689807289, 'max_leaf_nodes': 123, 'class_weight': None}. Best is trial 0 with value: 0.0.[0m
[32m[I 2025-07-03 00:27:35,630][0m Trial 1 finished with value: 0.0 and parameters: {'n_estimators': 424, 'max_depth': 9, 'min_samples_split': 15, 'min_samples_leaf': 3, 'min_weight_fraction_leaf': 0.2041813682865783, 'max_features': 'log2', 'max_samples': 0.7127117343982625, 'max_leaf_nodes': 554, 'class_weight': None}. Best is trial 0 with value: 0.0.[0m
[32m2025-07-03 00:27:35 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - tune - Hyperparameter tuning completed with 2 trials
[32m2025-07-03 00:27:35 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - tune - Best CV score: 0.0000
[32m2025-07-03 00:27:35 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - tune - Best parameters: {'n_estimators': 978, 'max_depth': 12, 'min_samples_split': 9, 'min_samples_leaf': 10, 'min_weight_fraction_leaf': 0.2877875263697933, 'max_features': 'sqrt', 'max_samples': 0.26134689807289, 'max_leaf_nodes': 123, 'class_weight': None}
[32m2025-07-03 00:27:35 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - tune - Training final model with best parameters
[32m2025-07-03 00:27:36 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - tune - Model training completed successfully
[32m2025-07-03 00:27:36 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - tune - Tuning completed - CV F1 Score: 0.0000
[32m2025-07-03 00:27:36 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - 504444 - tune - STEP_OUTPUT - Yielded output "result" of type "Any". (Type check passed).
[32m2025-07-03 00:27:36 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - tune - Writing file at: /workspaces/data-scientist-at-magenta/dagster_home/storage/tune using PickledObjectFilesystemIOManager...
[32m2025-07-03 00:27:37 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - 504444 - tune - ASSET_MATERIALIZATION - Materialized value tune.
[32m2025-07-03 00:27:37 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - 504444 - tune - HANDLED_OUTPUT - Handled output "result" using IO manager "io_manager"
[32m2025-07-03 00:27:37 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 530d708c-56c3-4ccc-bbe9-7525cf69a6b2 - 504444 - tune - STEP_SUCCESS - Finished execution of step "tune" in 12.36s.
